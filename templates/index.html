<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Shorts Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #fff;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .header h1 {
            font-size: 2.5rem;
            background: linear-gradient(90deg, #e94560, #ff6b9d);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #8892b0;
            font-size: 1.1rem;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #ccd6f6;
        }
        
        label .hint {
            font-weight: normal;
            color: #8892b0;
            font-size: 0.85rem;
        }
        
        textarea {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.3);
            color: #fff;
            font-family: 'Consolas', monospace;
            font-size: 14px;
            resize: vertical;
            transition: border-color 0.3s;
        }
        
        textarea:focus {
            outline: none;
            border-color: #e94560;
        }
        
        input[type="text"] {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.3);
            color: #fff;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        input[type="text"]:focus {
            outline: none;
            border-color: #e94560;
        }
        
        input[type="text"]::placeholder {
            color: #5a6a8a;
        }
        
        .btn {
            display: inline-block;
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
        }
        
        .btn-primary {
            background: linear-gradient(90deg, #e94560, #ff6b9d);
            color: #fff;
            width: 100%;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(233, 69, 96, 0.3);
        }
        
        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-download {
            background: linear-gradient(90deg, #00d9ff, #00ff88);
            color: #1a1a2e;
            margin-top: 15px;
        }
        
        .btn-download:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 217, 255, 0.3);
        }
        
        /* Progress Section */
        #progress-section {
            display: none;
            margin-top: 30px;
        }
        
        .progress-container {
            margin-bottom: 20px;
        }
        
        .progress-bar {
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #e94560, #ff6b9d);
            border-radius: 10px;
            transition: width 0.5s ease;
            width: 0%;
        }
        
        .progress-fill.encoding {
            background: linear-gradient(90deg, #e94560, #ff6b9d, #e94560);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite linear;
        }
        
        @keyframes shimmer {
            0% { background-position: 100% 0; }
            100% { background-position: -100% 0; }
        }
        
        .progress-text {
            text-align: center;
            margin-top: 10px;
            color: #8892b0;
            font-size: 0.95rem;
        }
        
        .elapsed-time {
            text-align: center;
            color: #5a6a8a;
            font-size: 0.85rem;
            margin-top: 5px;
        }
        
        /* Stock Videos Display */
        .stock-videos-section {
            margin-top: 20px;
            display: none;
        }
        
        .stock-videos-title {
            font-size: 0.9rem;
            color: #8892b0;
            margin-bottom: 12px;
            text-align: center;
        }
        
        .stock-videos-grid {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .stock-video-item {
            width: 100px;
            text-align: center;
        }
        
        .stock-video-thumb {
            width: 100px;
            height: 150px;
            border-radius: 8px;
            object-fit: cover;
            border: 2px solid rgba(233, 69, 96, 0.5);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            animation: fadeInUp 0.5s ease-out;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .stock-video-label {
            font-size: 0.7rem;
            color: #5a6a8a;
            margin-top: 6px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .status-message {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }
        
        .status-processing {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
        }
        
        .status-success {
            background: rgba(0, 255, 136, 0.2);
            color: #00ff88;
        }
        
        .status-error {
            background: rgba(255, 69, 96, 0.2);
            color: #ff4560;
        }
        
        /* Download Section */
        #download-section {
            display: none;
            text-align: center;
            margin-top: 20px;
        }
        
        .success-icon {
            font-size: 4rem;
            margin-bottom: 15px;
        }
        
        /* Example Script */
        .example-script {
            margin-top: 30px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            border-left: 4px solid #e94560;
        }
        
        .example-script h3 {
            color: #e94560;
            margin-bottom: 15px;
            font-size: 1rem;
        }
        
        .example-script pre {
            color: #8892b0;
            font-size: 0.85rem;
            white-space: pre-wrap;
            line-height: 1.6;
        }
        
        .load-example {
            background: transparent;
            border: 1px solid #e94560;
            color: #e94560;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85rem;
            margin-top: 15px;
            transition: all 0.3s;
        }
        
        .load-example:hover {
            background: #e94560;
            color: #fff;
        }
        
        /* Spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
            vertical-align: middle;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Footer */
        .footer {
            text-align: center;
            margin-top: 40px;
            color: #5a6a8a;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé¨ YouTube Shorts Generator</h1>
            <p>Create faceless videos from text scripts in seconds</p>
        </div>
        
        <div class="card">
            <form id="video-form">
                <div class="form-group">
                    <label for="script">
                        Video Script
                        <span class="hint">(Format: Hook/Core/CTA sections)</span>
                    </label>
                    <textarea 
                        id="script" 
                        name="script" 
                        placeholder="Enter your script here...

Example:
[Hook]
Did you know this simple trick can change your life?

[Core]
Here's the secret that nobody talks about...

[CTA]
Follow for more tips like this!"
                        required
                    ></textarea>
                </div>
                
                <div class="form-group">
                    <label for="stock_categories">
                        Stock Video Categories
                        <span class="hint">(Optional - comma separated, e.g., nature, technology, business)</span>
                    </label>
                    <input 
                        type="text" 
                        id="stock_categories" 
                        name="stock_categories"
                        placeholder="e.g., nature, sunset, ocean, mountains"
                    >
                </div>
                
                <button type="submit" class="btn btn-primary" id="generate-btn">
                    üöÄ Generate Video
                </button>
            </form>
            
            <div id="progress-section">
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <div class="progress-text" id="progress-text">Starting...</div>
                    <div class="elapsed-time" id="elapsed-time"></div>
                </div>
                
                <!-- Stock Videos Display -->
                <div class="stock-videos-section" id="stock-videos-section">
                    <div class="stock-videos-title">üìπ Stock Videos Being Used</div>
                    <div class="stock-videos-grid" id="stock-videos-grid"></div>
                </div>
                
                <div class="status-message status-processing" id="status-message">
                    <span class="spinner"></span>
                    <span id="status-text">Initializing...</span>
                </div>
            </div>
            
            <div id="download-section">
                <div class="success-icon">‚úÖ</div>
                <h3 style="color: #00ff88; margin-bottom: 10px;">Video Generated Successfully!</h3>
                <p style="color: #8892b0; margin-bottom: 20px;">Your YouTube Short is ready to download</p>
                <a id="download-btn" class="btn btn-download" href="#">
                    ‚¨áÔ∏è Download Video
                </a>
                <br><br>
                <button class="load-example" onclick="resetForm()">
                    Create Another Video
                </button>
            </div>
            
            <div class="example-script">
                <h3>üìù Example Script Format</h3>
                <pre>[Hook]
Did you know this simple habit can boost your productivity by 300%?

[Core]
Every morning, successful entrepreneurs start with this one thing.
They spend 10 minutes planning their top 3 priorities.
No distractions, no phone, just pure focus.
This simple practice sets the tone for the entire day.

[CTA]
Try it tomorrow and let me know in the comments how it worked!
Follow for more productivity tips!</pre>
                <button class="load-example" onclick="loadExample()">Load Example Script</button>
            </div>
        </div>
        
        <div class="footer">
            <p>Powered by Pexels Stock Videos | MoviePy | Edge TTS</p>
        </div>
    </div>
    
    <script>
        const form = document.getElementById('video-form');
        const generateBtn = document.getElementById('generate-btn');
        const progressSection = document.getElementById('progress-section');
        const downloadSection = document.getElementById('download-section');
        const progressFill = document.getElementById('progress-fill');
        const progressText = document.getElementById('progress-text');
        const statusMessage = document.getElementById('status-message');
        const statusText = document.getElementById('status-text');
        const downloadBtn = document.getElementById('download-btn');
        const stockVideosSection = document.getElementById('stock-videos-section');
        const stockVideosGrid = document.getElementById('stock-videos-grid');
        
        let currentJobId = null;
        let statusInterval = null;
        let stockVideosDisplayed = false;
        
        const exampleScript = `[Hook]
Did you know this simple habit can boost your productivity by 300%?

[Core]
Every morning, successful entrepreneurs start with this one thing.
They spend 10 minutes planning their top 3 priorities.
No distractions, no phone, just pure focus.
This simple practice sets the tone for the entire day.

[CTA]
Try it tomorrow and let me know in the comments how it worked!
Follow for more productivity tips!`;
        
        let startTime = null;
        let timerInterval = null;
        
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }
        
        function updateTimer() {
            if (!startTime) return;
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            document.getElementById('elapsed-time').textContent = `Elapsed: ${formatTime(elapsed)}`;
        }
        
        function loadExample() {
            document.getElementById('script').value = exampleScript;
            document.getElementById('stock_categories').value = 'productivity, success, morning, office';
        }
        
        function resetForm() {
            form.style.display = 'block';
            progressSection.style.display = 'none';
            downloadSection.style.display = 'none';
            stockVideosSection.style.display = 'none';
            stockVideosGrid.innerHTML = '';
            stockVideosDisplayed = false;
            generateBtn.disabled = false;
            generateBtn.innerHTML = 'üöÄ Generate Video';
            progressFill.style.width = '0%';
            progressFill.classList.remove('encoding');
            if (timerInterval) clearInterval(timerInterval);
            startTime = null;
        }
        
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(form);
            
            // Disable form
            generateBtn.disabled = true;
            generateBtn.innerHTML = '<span class="spinner"></span> Starting...';
            progressSection.style.display = 'block';
            downloadSection.style.display = 'none';
            
            // Start timer
            startTime = Date.now();
            timerInterval = setInterval(updateTimer, 1000);
            
            try {
                // Submit job
                const response = await fetch('/generate', {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error);
                }
                
                currentJobId = data.job_id;
                form.style.display = 'none';
                
                // Start polling status
                statusInterval = setInterval(checkStatus, 1000);
                
            } catch (error) {
                alert('Error: ' + error.message);
                resetForm();
            }
        });
        
        async function checkStatus() {
            if (!currentJobId) return;
            
            try {
                const response = await fetch(`/status/${currentJobId}`);
                const data = await response.json();
                
                // Update progress
                progressFill.style.width = data.progress + '%';
                progressText.textContent = data.progress + '% Complete';
                statusText.textContent = data.message;
                
                // Display stock videos when available
                if (data.stock_videos && data.stock_videos.length > 0 && !stockVideosDisplayed) {
                    stockVideosSection.style.display = 'block';
                    stockVideosGrid.innerHTML = '';
                    
                    data.stock_videos.forEach((video, index) => {
                        setTimeout(() => {
                            const item = document.createElement('div');
                            item.className = 'stock-video-item';
                            item.innerHTML = `
                                <img src="${video.thumbnail}" alt="${video.keyword}" class="stock-video-thumb" onerror="this.style.display='none'">
                                <div class="stock-video-label">${video.keyword}</div>
                            `;
                            stockVideosGrid.appendChild(item);
                        }, index * 200);  // Stagger animation
                    });
                    
                    stockVideosDisplayed = true;
                }
                
                // Add shimmer effect during encoding phase
                if (data.progress >= 40 && data.progress < 95) {
                    progressFill.classList.add('encoding');
                } else {
                    progressFill.classList.remove('encoding');
                }
                
                if (data.status === 'completed') {
                    clearInterval(statusInterval);
                    if (timerInterval) clearInterval(timerInterval);
                    progressSection.style.display = 'none';
                    downloadSection.style.display = 'block';
                    downloadBtn.href = `/download/${currentJobId}`;
                    
                } else if (data.status === 'error') {
                    clearInterval(statusInterval);
                    if (timerInterval) clearInterval(timerInterval);
                    statusMessage.className = 'status-message status-error';
                    statusText.textContent = 'Error: ' + data.error;
                    
                    setTimeout(() => {
                        alert('Generation failed: ' + data.error);
                        resetForm();
                    }, 2000);
                }
                
            } catch (error) {
                console.error('Status check error:', error);
            }
        }
    </script>
</body>
</html>
